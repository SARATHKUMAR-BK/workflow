name: "Input Validation"
description: "Input Validation for the parameters passed"
inputs:
  target_env:
    description: Target environment
    required: true
  platform:
    description: Target Platform
    required: true
  component:
    description: Deployed Component
    required: true
  tag:
    description: Deployed tag
    required: true
  app_version:
    description: App version
    required: true
runs:
  using: composite
  steps:
    - name: Validate Inputs
      run: |
        valid_env=(dev spro int stage)
        valid_components=("integration-server: 10.5.22.04" "integration-server: 10.7.22.04" "integration-server: 10.11.22.04" "universal-messaging: 10.5.22.04" "universal-messaging: 10.7.22.04" "universal-messaging: 10.11.22.04" "terracotta-server: 10.5.22.04" "terracotta-server: 10.7.22.04" "terracotta-server: 10.11.22.04" )
        valid_platform=(aws azure all)
        if [[ ! (" ${valid_env[*]} " =~ " ${{inputs.target_env}} ") ]]
        then
          echo "Provide the proper environment listed here [ ${valid_env[*]} ]" 
          exit 1
        fi
        if [[ ! (" ${valid_platform[*]} " =~ " ${{inputs.platform}} ") ]]
        then
          echo "Provide the proper platforms listed here [ ${valid_platform[*]} ]" 
          exit 1
        fi
        echo "above"
        components=($(echo ${{ inputs.component }} | sed -e 's\,\ \g'))
        tags=($(echo ${{ inputs.tag }} | sed -e 's\,\ \g'))
        echo "below"
          for cldp_component in ${!components[@]}
         do
          if [[ ! (" ${valid_components[*]} " =~ " ${components[$cldp_component]}: ${tags[$cldp_component]} ") ]]
          then
            echo " ${components[$cldp_component]}: ${tags[$cldp_component]} not found"
            exit 1 
          fi 
         done 
      shell: bash
